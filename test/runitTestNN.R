require(RUnit)

test.NN<-function()
{
	DATA=structure(list(x1 = c(1.66824013118334, 2.33812341864825, 3.59934383578104, 
5.70643784196122, 1.26720494581815, 5.64474886871073, 5.93556976775707, 
4.15191498077006, 3.95284011716578, 0.388214586787225, 1.29417642265985, 
1.10933879337353, 4.31669185581687, 2.4133948387136, 4.8370562989932, 
3.12713656526426, 4.50893006728715, 6.23232980114077, 2.38783145563323, 
4.88483239173352, 5.87292617462855, 1.33293077275123, 4.09458703214518, 
0.788885934185673, 1.67899697952353, 2.42602639316569, 0.084133944562211, 
2.40261439350479, 5.46442874361944, 2.13847581530135, 3.02899869841105, 
3.76718318499792, 3.10101148893568, 1.1700396971241, 5.19853987902384, 
4.20010038774853, 4.99035622329323, 0.678229804182266, 4.547209982805, 
2.58411345355487, 5.15815769317228, 4.06559910267013, 4.91931162852641, 
3.47482962764163, 3.32832628322357, 4.95967147708182, 0.146594267702523, 
2.99852493278210, 4.60126292305835, 4.3525607375112, 3.00097259222266, 
5.41113873123653, 2.75264530722876, 1.53810665428168, 0.4440895505466, 
0.62496431615803, 1.98719374364726, 3.25867518229564, 4.15950056942599, 
2.55618945465966, 5.7357685945848, 1.84476439786474, 2.88439502626482, 
2.08849733303981, 4.08953975557442, 1.62116724560871, 3.006788472786, 
4.8148719465373, 0.529338974533006, 5.49980611994917, 2.13045810112566, 
5.27435927455457, 2.17827660532401, 2.09716974109184, 2.99300314410316, 
5.60584747487153, 5.43080506228101, 2.45037656950541, 4.88404999388636, 
6.03574088593194, 2.73104608835746, 4.47686176045060, 2.51323874161292, 
2.04424786034023, 4.75691884474085, 1.27355299940578, 4.46810641664681, 
0.764612890201675, 1.54244982399213, 0.90040797125187, 1.50563602010372, 
0.370295613372914, 4.03561614898262, 5.50576184231463, 4.89406525686798, 
5.00963910010245, 2.86057375771623, 2.57663427902295, 5.09484799540639, 
3.80090796129022), x2 = c(1.96417178423144, 1.05959181580693, 
0.810780437663198, 2.97805218352005, 1.90047979331575, 0.639624405652285, 
0.388117044232786, 1.43435410293750, 2.77222340949811, 1.79628290142864, 
2.92851208476350, 2.19537753565237, 1.07018073624931, 1.29442107165232, 
0.444634682033211, 0.0392327264416963, 2.14669819828123, 0.309552707243711, 
1.33885304583237, 1.92030313541181, 2.97551586013287, 1.48678073356859, 
1.45304857310839, 0.520327004604042, 2.26446283352561, 1.36168646765873, 
1.53350935131311, 0.622635339852422, 0.685974428197369, 1.78713598893955, 
1.72461659484543, 0.231193140847608, 0.106621738756076, 1.92838647658937, 
2.78584559890442, 1.7942772670649, 1.68270224402659, 1.57808317174204, 
2.95528567163274, 1.52292546699755, 2.04836423601955, 1.80462365294807, 
0.716606033267453, 0.774497780017555, 2.18792887008749, 1.35771249420941, 
0.525380305247381, 2.24009480886161, 0.314962921198457, 2.59363484708592, 
1.84393491502851, 1.67147861653939, 0.986331957159564, 1.35939433635212, 
1.50132291787304, 0.542599083390087, 1.58889180840924, 0.225827237125486, 
0.833267797948793, 0.63809855771251, 0.854371442925185, 2.68528230884112, 
1.33870596997440, 2.33995466935448, 2.64185710460879, 1.23937262850814, 
0.191425441531464, 1.00646247505210, 2.17117783986032, 1.01284600049257, 
1.89124236744829, 2.52184366201982, 2.56839499413036, 1.17407784308307, 
1.14148165681399, 2.68633627798408, 1.93294728873298, 2.22323594614863, 
1.8159103395883, 2.70924483449198, 0.88119046529755, 0.573780329665169, 
2.65935282991268, 1.51001845719293, 2.63117262907326, 0.567580867325887, 
2.27430915716104, 2.17349667800590, 2.83117445488460, 1.64293976104818, 
2.13523160316981, 1.1667152994778, 0.302619378548115, 2.78190626576543, 
0.849697500932962, 1.77171947644092, 0.331081814831123, 2.52152109635063, 
0.953891053330153, 2.34855401096866), y = c(0.0587452275128349, 
1.70975896097374, 0.686467829273542, -2.47533652888445, 0.127516500972651, 
1.49269097477056, 1.70686808381685, -0.325703211258614, -2.48504374379337, 
0.39205806610347, -1.16688774308738, -0.40053733436317, 0.429449923036433, 
1.03306559505648, 0.756503073403441, 1.90534169356337, -2.15619001868222, 
1.77766793643897, 1.27946340563216, -1.71860134627644, -2.5098909633801, 
1.50748303347462, -0.638966914187037, 2.39570842320217, -0.312007698462406, 
1.26639506133635, 0.138444952497985, 2.28791530891769, 0.630626993817192, 
0.325033748760705, -0.177596985389117, 1.19993591830847, 2.1747688245511, 
-0.195098942799683, -2.67495659336049, -1.73564976724399, -1.26738591992718, 
0.46816661247944, -3.13036244202281, 0.609172084021465, -2.34578954012008, 
-0.939206572502364, 0.0734393812988897, 0.975498042284887, -1.64865563816145, 
-0.752251441233275, 2.44793041210743, -1.09352779251307, 0.555515972490688, 
-3.09243598912281, -0.276064098240656, -0.971754390428242, 1.39561346725259, 
1.16461120314880, 0.161113210406407, 2.00335380411638, 1.15223218158102, 
1.66226232066383, 0.114769361693196, 2.67092148924374, 0.90932070339771, 
-0.898020118039779, 1.00427355067930, -0.279345464097439, -2.7372249801399, 
2.25367685227403, 2.02802230280903, -0.315160989798374, -0.664497183521174, 
0.410055979373923, 0.849520785262827, -2.44528025379886, -0.73409907067413, 
1.61629309984983, 0.88906896039552, -2.43252754632762, -1.24571819785827, 
-0.00844962547697625, -1.18927324877161, -1.73009669969609, 1.33436503806784, 
0.97676940671559, -1.12387402561880, 0.609657775449778, -2.60139952335814, 
2.59907867543013, -1.86301827540994, -0.651280719654598, -1.02263189924599, 
0.385793172183776, -0.120501642150764, 1.25833441283036, 0.929122889056186, 
-2.34605284580425, 0.00603145030513264, -1.64229586090062, 2.56339448375657, 
-1.37049438129872, 0.342101493582236, -2.12030490100527)), .Names = c("x1", 
"x2", "y"), row.names = c(NA, -100L), class = "data.frame")

nearest=structure(list(nn.idx = structure(list(X1 = c(91L, 14L, 44L, 
21L, 34L, 29L, 18L, 23L, 65L, 55L, 89L, 34L, 59L, 19L, 49L, 33L, 
87L, 7L, 26L, 79L, 4L, 54L, 8L, 56L, 91L, 19L, 55L, 60L, 6L, 
71L, 51L, 93L, 16L, 5L, 72L, 42L, 96L, 90L, 85L, 26L, 77L, 36L, 
95L, 3L, 48L, 37L, 56L, 45L, 15L, 65L, 31L, 77L, 81L, 66L, 38L, 
24L, 84L, 33L, 13L, 28L, 6L, 89L, 75L, 73L, 9L, 54L, 33L, 95L, 
88L, 61L, 30L, 35L, 64L, 2L, 63L, 94L, 52L, 98L, 20L, 21L, 53L, 
49L, 98L, 57L, 39L, 24L, 17L, 69L, 11L, 38L, 25L, 55L, 32L, 76L, 
43L, 37L, 67L, 83L, 95L, 65L), X2 = c(25L, 74L, 59L, 94L, 12L, 
61L, 6L, 36L, 50L, 38L, 62L, 5L, 8L, 26L, 43L, 67L, 20L, 6L, 
14L, 96L, 80L, 66L, 42L, 86L, 1L, 14L, 10L, 81L, 61L, 57L, 63L, 
58L, 67L, 12L, 94L, 23L, 79L, 55L, 50L, 19L, 20L, 23L, 15L, 58L, 
51L, 68L, 24L, 51L, 82L, 87L, 48L, 96L, 75L, 22L, 10L, 47L, 30L, 
16L, 82L, 81L, 70L, 73L, 40L, 78L, 50L, 22L, 16L, 99L, 10L, 29L, 
57L, 94L, 83L, 19L, 53L, 4L, 41L, 64L, 96L, 4L, 60L, 15L, 73L, 
30L, 50L, 56L, 50L, 12L, 62L, 34L, 1L, 27L, 82L, 4L, 68L, 79L, 
33L, 78L, 68L, 9L), X3 = c(5L, 19L, 32L, 76L, 91L, 7L, 61L, 42L, 
100L, 69L, 12L, 88L, 23L, 2L, 82L, 58L, 36L, 61L, 40L, 37L, 76L, 
5L, 36L, 47L, 64L, 40L, 92L, 2L, 70L, 84L, 40L, 3L, 58L, 90L, 
76L, 8L, 20L, 10L, 65L, 14L, 96L, 8L, 99L, 75L, 100L, 96L, 92L, 
98L, 43L, 85L, 45L, 37L, 63L, 57L, 92L, 86L, 71L, 67L, 93L, 53L, 
29L, 64L, 53L, 25L, 100L, 74L, 97L, 43L, 12L, 6L, 84L, 76L, 62L, 
14L, 81L, 72L, 96L, 73L, 37L, 76L, 75L, 59L, 78L, 74L, 87L, 66L, 
85L, 34L, 25L, 5L, 5L, 38L, 59L, 35L, 99L, 20L, 16L, 73L, 43L, 
45L), X4 = c(71L, 26L, 93L, 80L, 1L, 70L, 29L, 13L, 39L, 27L, 
25L, 91L, 68L, 40L, 95L, 97L, 50L, 29L, 2L, 41L, 94L, 90L, 13L, 
92L, 62L, 2L, 38L, 53L, 99L, 1L, 48L, 44L, 97L, 91L, 85L, 17L, 
46L, 92L, 9L, 63L, 79L, 17L, 68L, 32L, 31L, 99L, 27L, 31L, 93L, 
39L, 63L, 41L, 60L, 84L, 27L, 92L, 74L, 97L, 3L, 97L, 7L, 25L, 
31L, 62L, 87L, 84L, 58L, 46L, 38L, 99L, 64L, 41L, 98L, 84L, 40L, 
21L, 37L, 83L, 41L, 94L, 28L, 43L, 64L, 19L, 35L, 54L, 65L, 10L, 
73L, 22L, 34L, 10L, 49L, 72L, 15L, 41L, 58L, 48L, 70L, 50L), 
    X5 = c(57L, 53L, 58L, 35L, 22L, 99L, 70L, 59L, 87L, 88L, 
    91L, 25L, 82L, 74L, 68L, 32L, 79L, 70L, 74L, 17L, 35L, 34L, 
    59L, 55L, 5L, 74L, 69L, 97L, 43L, 19L, 45L, 16L, 32L, 22L, 
    4L, 87L, 41L, 27L, 35L, 31L, 37L, 100L, 82L, 59L, 98L, 79L, 
    55L, 78L, 95L, 9L, 40L, 79L, 2L, 74L, 90L, 55L, 19L, 32L, 
    8L, 2L, 99L, 11L, 26L, 71L, 39L, 57L, 60L, 13L, 90L, 95L, 
    78L, 85L, 78L, 26L, 31L, 35L, 20L, 71L, 46L, 72L, 2L, 95L, 
    48L, 71L, 72L, 22L, 20L, 90L, 91L, 55L, 12L, 56L, 3L, 21L, 
    82L, 52L, 60L, 64L, 46L, 42L), X6 = c(34L, 81L, 75L, 72L, 
    90L, 18L, 99L, 68L, 85L, 90L, 88L, 69L, 95L, 84L, 99L, 44L, 
    85L, 99L, 84L, 77L, 72L, 1L, 17L, 38L, 12L, 84L, 90L, 74L, 
    7L, 26L, 75L, 33L, 60L, 88L, 39L, 100L, 52L, 88L, 87L, 30L, 
    52L, 87L, 49L, 93L, 42L, 95L, 86L, 83L, 59L, 17L, 78L, 46L, 
    14L, 5L, 69L, 38L, 1L, 44L, 23L, 67L, 18L, 91L, 14L, 98L, 
    17L, 1L, 28L, 82L, 55L, 46L, 1L, 77L, 25L, 57L, 14L, 80L, 
    79L, 30L, 17L, 35L, 63L, 93L, 62L, 26L, 17L, 74L, 36L, 5L, 
    64L, 10L, 64L, 47L, 44L, 80L, 46L, 46L, 28L, 62L, 29L, 87L
    ), X7 = c(30L, 28L, 13L, 85L, 25L, 43L, 43L, 17L, 17L, 92L, 
    73L, 90L, 43L, 53L, 29L, 60L, 42L, 43L, 57L, 87L, 77L, 38L, 
    3L, 66L, 89L, 63L, 88L, 14L, 95L, 40L, 26L, 59L, 44L, 1L, 
    21L, 79L, 77L, 34L, 17L, 2L, 72L, 13L, 29L, 67L, 9L, 52L, 
    38L, 100L, 68L, 100L, 75L, 20L, 26L, 1L, 88L, 27L, 26L, 3L, 
    68L, 75L, 43L, 83L, 81L, 83L, 85L, 2L, 81L, 15L, 34L, 43L, 
    40L, 4L, 71L, 66L, 44L, 77L, 72L, 48L, 52L, 77L, 14L, 13L, 
    71L, 14L, 65L, 92L, 42L, 38L, 12L, 88L, 62L, 90L, 58L, 85L, 
    29L, 77L, 81L, 71L, 15L, 36L), X8 = c(64L, 60L, 23L, 41L, 
    88L, 95L, 15L, 46L, 45L, 34L, 64L, 1L, 46L, 63L, 59L, 3L, 
    96L, 15L, 63L, 46L, 85L, 57L, 68L, 22L, 73L, 57L, 47L, 19L, 
    15L, 78L, 19L, 67L, 81L, 38L, 41L, 20L, 17L, 69L, 72L, 51L, 
    17L, 79L, 46L, 81L, 78L, 20L, 10L, 40L, 13L, 36L, 26L, 70L, 
    28L, 34L, 34L, 90L, 54L, 93L, 49L, 14L, 95L, 1L, 19L, 30L, 
    42L, 5L, 44L, 59L, 27L, 52L, 25L, 20L, 89L, 54L, 26L, 41L, 
    46L, 51L, 77L, 41L, 97L, 68L, 25L, 66L, 41L, 47L, 79L, 91L, 
    1L, 12L, 71L, 24L, 15L, 41L, 49L, 17L, 53L, 51L, 6L, 17L), 
    X9 = c(22L, 40L, 8L, 77L, 54L, 15L, 95L, 79L, 42L, 12L, 34L, 
    22L, 36L, 57L, 13L, 28L, 65L, 95L, 53L, 52L, 41L, 91L, 79L, 
    54L, 71L, 53L, 56L, 26L, 68L, 64L, 14L, 82L, 3L, 25L, 80L, 
    13L, 68L, 22L, 100L, 84L, 85L, 20L, 70L, 53L, 65L, 70L, 90L, 
    73L, 99L, 42L, 19L, 99L, 19L, 90L, 22L, 22L, 66L, 60L, 44L, 
    74L, 52L, 98L, 51L, 1L, 36L, 30L, 32L, 70L, 5L, 68L, 26L, 
    21L, 30L, 40L, 19L, 85L, 76L, 40L, 87L, 52L, 26L, 99L, 45L, 
    54L, 20L, 28L, 100L, 55L, 5L, 69L, 22L, 22L, 13L, 77L, 13L, 
    87L, 44L, 45L, 61L, 48L), X10 = c(84L, 84L, 67L, 39L, 38L, 
    68L, 68L, 3L, 36L, 5L, 5L, 38L, 3L, 81L, 93L, 81L, 41L, 68L, 
    30L, 36L, 39L, 84L, 46L, 90L, 34L, 30L, 34L, 67L, 46L, 14L, 
    78L, 49L, 28L, 54L, 50L, 37L, 99L, 5L, 94L, 75L, 46L, 45L, 
    13L, 97L, 83L, 43L, 22L, 63L, 32L, 20L, 98L, 72L, 40L, 30L, 
    5L, 66L, 14L, 81L, 32L, 19L, 46L, 78L, 2L, 91L, 45L, 86L, 
    53L, 37L, 91L, 7L, 19L, 80L, 1L, 30L, 2L, 52L, 94L, 62L, 
    36L, 85L, 19L, 32L, 30L, 2L, 94L, 90L, 39L, 22L, 34L, 54L, 
    89L, 69L, 16L, 39L, 70L, 68L, 75L, 30L, 82L, 23L)), .Names = c("X1", 
"X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10"), row.names = c(NA, 
-100L), class = "data.frame"), nn.dists = structure(list(X1 = c(0.236011776390972, 
0.246597984743504, 0.129692788058613, 0.166507651027422, 0.101093365386212, 
0.186181825382786, 0.306983505192751, 0.0602990622523054, 0.188897232884837, 
0.300205602003412, 0.266672638265611, 0.273804355947308, 0.284318203517481, 
0.0512609684267651, 0.269097160320835, 0.0722758506963537, 0.133981816967192, 
0.306983505192751, 0.0444996450031802, 0.104395727720253, 0.166507651027422, 
0.241504526991917, 0.0602990622523054, 0.165427755682812, 0.216228428173153, 
0.0444996450031802, 0.361391760804229, 0.154351580864312, 0.186181825382786, 
0.104414662700247, 0.122565591253808, 0.277773223305740, 0.0722758506963537, 
0.101093365386212, 0.274673630728295, 0.134898641166560, 0.0910818148959892, 
0.231450891332988, 0.386040245481724, 0.225808621558782, 0.296070362587791, 
0.134898641166560, 0.135464822176367, 0.129692788058613, 0.333901506317657, 
0.326435125463377, 0.478679840373555, 0.333901506317657, 0.269097160320835, 
0.267404979496625, 0.122565591253808, 0.262207229334793, 0.107337130420095, 
0.145959830725385, 0.246401694285180, 0.165427755682812, 0.0973456612474712, 
0.197655738711031, 0.284318203517481, 0.154351580864312, 0.233239963376089, 
0.335676361772687, 0.225151400088872, 0.245449179496668, 0.188897232884837, 
0.145959830725385, 0.126766102632998, 0.175632677801445, 0.235285342519277, 
0.284240171039121, 0.104414662700247, 0.274673630728295, 0.245449179496668, 
0.266769048372240, 0.225151400088872, 0.138386258020230, 0.262207229334793, 
0.323905912332019, 0.104395727720253, 0.312103971959119, 0.107337130420095, 
0.287162149636031, 0.151712164773384, 0.0973456612474712, 0.386040245481724, 
0.486965185255786, 0.133981816967192, 0.235285342519277, 0.266672638265611, 
0.231450891332988, 0.216228428173153, 0.342648221141928, 0.277773223305740, 
0.138386258020230, 0.135464822176367, 0.0910818148959892, 0.202194573384522, 
0.151712164773384, 0.226207878855115, 0.411503362575071), X2 = c(0.300483650258063, 
0.266769048372240, 0.560607926826215, 0.280613752132646, 0.334494245874129, 
0.233239963376089, 0.384490244571071, 0.363134296812014, 0.437801837540433, 
0.362932429463116, 0.601920129531708, 0.334494245874129, 0.399716974314585, 
0.0684411401700365, 0.284137915683206, 0.194026508213572, 0.438813493429527, 
0.673942637207115, 0.0512609684267651, 0.194045917676893, 0.312103971959119, 
0.379856597592994, 0.352768106295801, 0.486965185255786, 0.300483650258063, 
0.0684411401700365, 0.401889257901096, 0.417992979699113, 0.319347568162247, 
0.249373255017627, 0.412113130567958, 0.508536313093775, 0.126766102632998, 
0.273804355947308, 0.307247218171014, 0.357169553279594, 0.170427143184074, 
0.246401694285180, 0.410706278974203, 0.269089722846719, 0.301838310847806, 
0.352768106295801, 0.284137915683206, 0.589713582072101, 0.474860274321866, 
0.379925624305494, 0.642311544876078, 0.396167455148187, 0.287162149636031, 
0.33958754425466, 0.396167455148187, 0.413823855999866, 0.286082713650786, 
0.241504526991917, 0.300205602003412, 0.478679840373555, 0.249373255017627, 
0.228297873813691, 0.40994130282859, 0.299447020157921, 0.284240171039121, 
0.353402089502381, 0.352286596385134, 0.380236560750979, 0.267404979496625, 
0.379856597592994, 0.194026508213572, 0.284868991506998, 0.400577467761624, 
0.328780448826742, 0.334575158484485, 0.348108756328961, 0.347092150065994, 
0.334118391803279, 0.286082713650786, 0.308571857909803, 0.296070362587791, 
0.380236560750979, 0.133136982036799, 0.425085739186668, 0.299447020157921, 
0.382646970324079, 0.347092150065994, 0.292699562516750, 0.406096742118026, 
0.64906961842753, 0.33958754425466, 0.345419629217844, 0.335676361772687, 
0.392659006021875, 0.236011776390972, 0.465216484185904, 0.517905349509402, 
0.280613752132646, 0.175632677801445, 0.133136982036799, 0.328926478632499, 
0.323905912332019, 0.284868991506998, 0.450087923898549), X3 = c(0.406061435755348, 
0.283650706920011, 0.603399935180262, 0.308571857909803, 0.334600940546687, 
0.384490244571071, 0.507260951681704, 0.380197278366358, 0.450087923898549, 
0.400577467761624, 0.75607619741701, 0.345419629217844, 0.442626629564225, 
0.246597984743504, 0.382646970324079, 0.228297873813691, 0.468589675220564, 
0.737157029815144, 0.269089722846719, 0.259979735006593, 0.393644335149952, 
0.41888757007307, 0.357169553279594, 0.642311544876078, 0.416400716626147, 
0.225808621558782, 0.465216484185904, 0.441689990509774, 0.328780448826742, 
0.292699562516750, 0.488469233568798, 0.603399935180262, 0.197655738711031, 
0.392659006021875, 0.419286993102876, 0.363134296812014, 0.259979735006593, 
0.362932429463116, 0.554706682418714, 0.285235173401545, 0.313990597772862, 
0.380197278366358, 0.295156224470329, 0.605668164977817, 0.499133126858338, 
0.417011444311516, 0.679229612781478, 0.507141478306772, 0.51232037683697, 
0.406096742118026, 0.474860274321866, 0.420932166512634, 0.376198662109941, 
0.504329558439178, 0.342648221141928, 0.64906961842753, 0.334575158484485, 
0.254225093111770, 0.544917511776807, 0.39982671558952, 0.319347568162247, 
0.422678272782587, 0.376198662109941, 0.416400716626147, 0.411503362575071, 
0.480459972016275, 0.202194573384522, 0.3080980428663, 0.580504448847262, 
0.400378270231645, 0.390850195556643, 0.370057087023266, 0.353402089502381, 
0.338350121957066, 0.369287155796144, 0.370057087023266, 0.450971368441805, 
0.439514685660414, 0.170427143184074, 0.430503364486771, 0.369287155796144, 
0.40994130282859, 0.440624090337936, 0.340083551014743, 0.459090575166621, 
0.756399256051709, 0.459090575166621, 0.47376144483249, 0.582929830654645, 
0.448181758632987, 0.334600940546687, 0.51385503033503, 0.544917511776807, 
0.307247218171014, 0.226207878855115, 0.194045917676893, 0.395261458735392, 
0.401105969150166, 0.295156224470329, 0.499133126858338), X4 = c(0.467936055001033, 
0.314623761986401, 0.669747111428793, 0.425085739186668, 0.406061435755348, 
0.400378270231645, 0.557398318805931, 0.399716974314585, 0.621922285336223, 
0.401889257901096, 0.76749480066934, 0.400835409000051, 0.502238409124798, 
0.285235173401545, 0.409054896722898, 0.395261458735392, 0.473501568465566, 
0.855199009674408, 0.283650706920011, 0.301838310847806, 0.41508351202457, 
0.459849557660139, 0.442626629564225, 0.770088101731181, 0.452291794960212, 
0.314623761986401, 0.59576565517435, 0.504774078180624, 0.456474804860314, 
0.502457233436403, 0.516378194269397, 0.616968826961672, 0.328926478632499, 
0.394220494631521, 0.467923995449652, 0.468589675220564, 0.326435125463377, 
0.51385503033503, 0.621922285336223, 0.352286596385134, 0.359402065622738, 
0.55996190830551, 0.3080980428663, 0.616968826961672, 0.551593389572131, 
0.425845567336507, 1.01006210971811, 0.516378194269397, 0.565781438426048, 
0.410706278974203, 0.518504210016801, 0.453918688523629, 0.39982671558952, 
0.528078163011375, 0.361391760804229, 0.674075069530019, 0.429144900754461, 
0.411780609524239, 0.560607926826215, 0.432329832832209, 0.507260951681704, 
0.452291794960212, 0.412113130567958, 0.422678272782587, 0.527640228326605, 
0.502241347507433, 0.254225093111770, 0.379925624305494, 0.61149796770225, 
0.409227037753042, 0.450669985621756, 0.487530075340267, 0.401105969150166, 
0.340083551014743, 0.559187052214212, 0.393644335149952, 0.506574537620857, 
0.440624090337936, 0.359402065622738, 0.53493688437817, 0.417992979699113, 
0.464931250154034, 0.531432450199108, 0.383858417910424, 0.467923995449652, 
0.834839628934542, 0.527640228326605, 0.532884524125967, 0.687988910414366, 
0.459849557660139, 0.394220494631521, 0.62982255837208, 0.565781438426048, 
0.348108756328961, 0.409054896722898, 0.313990597772862, 0.411780609524239, 
0.507141478306772, 0.409227037753042, 0.603643439245601), X5 = c(0.492510372638886, 
0.420945843311685, 0.676923465605136, 0.543050376968425, 0.41888757007307, 
0.633367583874924, 0.761692999534781, 0.601134167387148, 0.716531898844188, 
0.532884524125967, 0.820980562393915, 0.573832055073565, 0.52160115222963, 
0.338350121957066, 0.562265608500437, 0.668212897309958, 0.500135548417077, 
1.01548628736942, 0.334118391803279, 0.438813493429527, 0.700550985791833, 
0.4706900623424, 0.623170904792368, 1.03982572002286, 0.549596517987176, 
0.378607572069535, 0.777707284264057, 0.54289063099421, 0.545977073141833, 
0.512967671930858, 0.551593389572131, 0.668212897309958, 0.677718793345355, 
0.4706900623424, 0.543050376968425, 0.549779816867719, 0.402325770591236, 
0.59576565517435, 0.673008597236784, 0.488469233568798, 0.402325770591236, 
0.604914568101485, 0.464931250154034, 0.687188630240285, 0.822389592956007, 
0.464396247003072, 1.02027811230717, 0.548407557766018, 0.609650947221606, 
0.437801837540433, 0.526135540726905, 0.546519038702468, 0.420945843311685, 
0.588976856685599, 0.477788479712356, 0.975636751891136, 0.472260477974104, 
0.508536313093775, 0.601134167387148, 0.474562285354383, 0.648601084879117, 
0.601920129531708, 0.458944339852868, 0.450669985621756, 0.554706682418714, 
0.506101822151541, 0.634473283799488, 0.502238409124798, 0.64554447424874, 
0.627327208173613, 0.461050499087373, 0.528864275067598, 0.439514685660414, 
0.378607572069535, 0.584244842410147, 0.419286993102876, 0.546119063573114, 
0.461050499087373, 0.464396247003072, 0.784105323019519, 0.431526669204788, 
0.500189007099627, 0.641311137869247, 0.390850195556643, 0.528864275067598, 
0.92111568983927, 0.546791369488107, 0.547659516642513, 0.696915855042521, 
0.477788479712356, 0.400835409000051, 0.674075069530019, 0.669747111428793, 
0.41508351202457, 0.500189007099627, 0.413823855999866, 0.432329832832209, 
0.520810949813738, 0.425845567336507, 0.604914568101485), X6 = c(0.499483994478151, 
0.431526669204788, 0.690660792815289, 0.62834552875119, 0.448181758632987, 
0.673942637207115, 1.01336732129795, 0.789052079189788, 0.816356492469561, 
0.534655198975085, 0.92221786978507, 0.580504448847262, 0.618039562889695, 
0.427494706743994, 0.570787710489741, 0.81332967770472, 0.544255370055496, 
1.30730132816201, 0.383858417910424, 0.546119063573114, 0.751066439940504, 
0.583382019867879, 0.807978931206182, 1.06352850842175, 0.573832055073565, 
0.409581771134328, 0.823576530276898, 0.630385017316357, 0.557398318805931, 
0.513510106997126, 0.584244842410147, 0.677718793345355, 0.761116717803986, 
0.47376144483249, 0.673008597236784, 0.683064639821316, 0.420932166512634, 
0.601647139934753, 0.685555531989175, 0.518073454765871, 0.453918688523629, 
0.618560110799686, 0.51232037683697, 0.732905688537808, 0.830959746185685, 
0.512233745007506, 1.12774858474837, 0.641311137869247, 0.681024171634154, 
0.473501568465566, 0.668599470864908, 0.549792561877648, 0.458268243343011, 
0.605112557617175, 0.67525778840425, 1.03685317641628, 0.492510372638886, 
0.589713582072101, 0.623170904792368, 0.634473283799488, 0.737157029815144, 
0.646191794603063, 0.473077508335241, 0.520810949813738, 0.64889951153781, 
0.726326147604185, 0.742272385641062, 0.549058034122996, 0.67525778840425, 
0.640841892290125, 0.467936055001033, 0.609322757631574, 0.58451253450147, 
0.429144900754461, 0.599446621716765, 0.430503364486771, 0.559141084414598, 
0.536157862155194, 0.500135548417077, 0.840698045124706, 0.482531173891416, 
0.517905349509402, 0.668977044544178, 0.409581771134328, 0.544255370055496, 
1.02283093362891, 0.549779816867719, 0.571958909096368, 0.734482647741545, 
0.534655198975085, 0.617769248138524, 0.679229612781478, 0.732905688537808, 
0.53493688437817, 0.512233745007506, 0.417011444311516, 0.54289063099421, 
0.749967504404615, 0.456474804860314, 0.671316674265684), X7 = c(0.502457233436403, 
0.441689990509774, 0.762808427297373, 1.01089650873647, 0.549596517987176, 
0.729510356634175, 1.06802884861299, 0.796802285496142, 0.83696942745474, 
0.62982255837208, 0.95462948412087, 0.59062643290159, 0.698688529352817, 
0.458268243343011, 0.672191235702231, 0.827418205607916, 0.55996190830551, 
1.37466691669020, 0.472260477974104, 0.546791369488107, 1.13243997812433, 
0.661036680874484, 0.81103278685464, 1.09987217011782, 0.582929830654645, 
0.458944339852868, 0.934149545729152, 0.671872225537586, 0.593396790996777, 
0.518073454765871, 0.703771183064962, 0.718614516168434, 0.765374684266918, 
0.499483994478151, 0.700550985791833, 0.684291643645383, 0.506574537620857, 
0.603812368358267, 0.809493084586292, 0.524584759213413, 0.487530075340267, 
0.776179082797124, 0.545977073141833, 0.747687016435507, 0.855229581790917, 
0.549792561877648, 1.17933017801385, 0.809680136201665, 0.723740594337102, 
0.603643439245601, 0.70249846411186, 0.582161493224307, 0.497564994323163, 
0.618619821274691, 0.744683003079026, 1.12889355118884, 0.494162282199807, 
0.676923465605136, 0.67787022217656, 0.666483866080982, 0.827998360821706, 
0.668977044544178, 0.482531173891416, 0.531432450199108, 0.667464610802764, 
0.739153092853582, 0.742838912942347, 0.562265608500437, 0.685160610373742, 
0.65171464058567, 0.584346231223676, 0.62834552875119, 0.678838927261982, 
0.480459972016275, 0.605668164977817, 0.77345640816423, 0.609322757631574, 
0.548407557766018, 0.546519038702468, 0.984167277594455, 0.521211905493952, 
0.52160115222963, 0.858204347040437, 0.427494706743994, 0.667464610802764, 
1.08389850687826, 0.618560110799686, 0.601647139934753, 0.769300258253376, 
0.547659516642513, 0.646191794603063, 0.71260707951436, 0.780726775959914, 
0.763862856961723, 0.593396790996777, 0.450971368441805, 0.565152142743446, 
0.77222047229388, 0.570787710489741, 0.683064639821316), X8 = c(0.563763152807659, 
0.474562285354383, 0.81103278685464, 1.07931960108381, 0.571958909096368, 
0.77952330975416, 1.09996640150424, 0.811384306923839, 0.855229581790917, 
0.792907218862026, 0.988607879747976, 0.604836180213877, 0.704341753126727, 
0.473077508335241, 0.781100163522969, 0.904580331988292, 0.625554615821692, 
1.40179716282642, 0.496563592412595, 0.567546578057082, 1.16792320857993, 
0.662183287837146, 0.847496018207762, 1.10906158377220, 0.58451253450147, 
0.494162282199807, 1.01006210971811, 0.716370251763211, 0.672191235702231, 
0.536157862155194, 0.74827063884564, 0.761433902757647, 0.858388670568926, 
0.603812368358267, 0.738586136843, 0.696233033383141, 0.668627990179494, 
0.61149796770225, 0.846532969345661, 0.526135540726905, 0.656632376864347, 
0.818528710936862, 0.642375600125763, 0.751396887405284, 0.878659370540017, 
0.567546578057082, 1.29366679928599, 0.828292665079825, 0.807053059272525, 
0.813766980767114, 0.750417681561825, 0.664574170986047, 0.504774078180624, 
0.677661671192194, 0.842251089936575, 1.13429220840158, 0.504329558439178, 
0.780726775959914, 0.681024171634154, 0.671676666743351, 0.841716314714988, 
0.742402320463953, 0.496563592412595, 0.555073276338243, 0.837575672665587, 
0.749901322197119, 0.747687016435507, 0.67787022217656, 0.777707284264057, 
0.664574170986047, 0.585756485766248, 0.716646494160211, 0.687988910414366, 
0.588976856685599, 0.608237449375466, 0.779380822811489, 0.743546853892354, 
0.668599470864908, 0.559141084414598, 1.09859702605255, 0.565152142743446, 
0.549058034122996, 0.92298289629905, 0.502241347507433, 0.707572071597253, 
1.12774858474837, 0.618981853852698, 0.742010441302568, 0.876080380046818, 
0.59062643290159, 0.670770735855821, 0.770088101731181, 0.813925463708409, 
0.811734287747337, 0.609650947221606, 0.625554615821692, 0.664079287017798, 
0.799491111375143, 0.633367583874924, 0.73623438638523), X9 = c(0.583382019867879, 
0.524584759213413, 0.833174043221525, 1.08084118645717, 0.605112557617175, 
0.830896070212124, 1.13920505801628, 0.825594839590175, 0.974147769944414, 
0.824194545232431, 1.00780015814268, 0.743036204478216, 0.73342304051993, 
0.518035122594899, 0.813687298455334, 0.93021018415492, 0.64889951153781, 
1.44315916953303, 0.507306873869283, 0.582161493224307, 1.17068531902440, 
0.671055610772805, 0.868861570984749, 1.12488473837457, 0.585756485766248, 
0.497564994323163, 1.12889355118884, 0.739421862836023, 0.724318038441937, 
0.555073276338243, 0.751023501795905, 0.788041662857024, 0.862655551862374, 
0.609905593513418, 0.840698045124706, 0.73342304051993, 0.698637929496542, 
0.661036680874484, 0.96181599870726, 0.54001986041172, 0.707572071597253, 
0.827360214521277, 0.65171464058567, 0.752611394582641, 0.886282569265615, 
0.640841892290125, 1.34802605201404, 0.883509100318325, 0.807375613747477, 
0.839574680624366, 0.794386397144897, 0.784201339226438, 0.507306873869283, 
0.697895134102555, 0.888960175381645, 1.18012520191501, 0.506101822151541, 
0.814526757885107, 0.687188630240285, 0.705671943462553, 0.879231870071433, 
0.749967504404615, 0.518504210016801, 0.563763152807659, 0.85476033740322, 
0.753427405466888, 0.761433902757647, 0.684963919709973, 0.785953957928587, 
0.684963919709973, 0.606456978079558, 0.751066439940504, 0.782272162407786, 
0.599006547391641, 0.636543979414293, 0.850719017782432, 0.77345640816423, 
0.712965862691953, 0.618981853852698, 1.21123349308619, 0.569133923378279, 
0.725528186109925, 0.941598773568739, 0.528078163011375, 0.72228617079571, 
1.13040286030688, 0.671316674265684, 0.744683003079026, 0.970542269060842, 
0.64554447424874, 0.671055610772805, 1.01444976818522, 0.817406869807493, 
0.852261616850716, 0.618039562889695, 0.738819351680112, 0.757580353441158, 
0.822389592956007, 0.648601084879117, 0.809680136201665), X10 = c(0.589607544766748, 
0.537816886162126, 0.857159535586887, 1.15945139764780, 0.671439721097251, 
0.907339999733853, 1.27996667077775, 0.833174043221525, 1.00872012912832, 
0.885144645551363, 1.02838604270105, 0.75293246196254, 0.762808427297373, 
0.521211905493952, 0.813925463708409, 0.9304732666313, 0.656632376864347, 
1.57951574669068, 0.512967671930858, 0.696233033383141, 1.32587053734136, 
0.71169655815898, 0.870321816807536, 1.12813854011044, 0.609905593513418, 
0.513510106997126, 1.15547360312274, 0.742272385641062, 0.840245159136388, 
0.564223766914607, 0.763822509195242, 0.83827584096346, 0.868348167167255, 
0.677661671192194, 0.867540016938177, 0.79809352295233, 0.736263731365127, 
0.671439721097251, 0.974105787760379, 0.559187052214212, 0.71860740772921, 
0.830959746185685, 0.698688529352817, 0.757580353441158, 0.941598773568739, 
0.642375600125763, 1.52698562101527, 0.908585424950282, 0.83827584096346, 
0.858305719329975, 0.799491111375143, 0.861295147057701, 0.562437179161376, 
0.737160803937434, 0.914792416423654, 1.2156947190074, 0.518035122594899, 
0.841364024433028, 0.718614516168434, 0.720694989892607, 0.925029161542676, 
0.761743358170385, 0.613447129217029, 0.617769248138524, 0.886282569265615, 
0.756399256051709, 0.834544856306394, 0.698637929496542, 0.976958572879276, 
0.761692999534781, 0.609405453081753, 0.784105323019519, 0.790710371965868, 
0.614448111696661, 0.659979848837868, 1.03336710216695, 0.852261616850716, 
0.761743358170385, 0.684291643645383, 1.28120298247197, 0.572058844646084, 
0.788041662857024, 0.949320529965906, 0.537816886162126, 0.763862856961723, 
1.13825918065422, 0.685555531989175, 0.891383197042684, 0.976583553183374, 
0.697895134102555, 0.696915855042521, 1.01697580392102, 0.945889889226492, 
0.974105787760379, 0.627327208173613, 0.789653419091234, 0.821148857555487, 
0.855163332538318, 0.725528186109925, 0.942431634600376)), .Names = c("X1", 
"X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10"), row.names = c(NA, 
-100L), class = "data.frame")), .Names = c("nn.idx", "nn.dists"
))

	nearest.func <- nn(DATA)
	checkEquals(nearest.func,nearest)
}

test.NN2<-function()
{
	a=structure(c(-0.626453810742332, 0.183643324222082, -0.835628612410047, 
	1.59528080213779, 0.329507771815361, -0.820468384118015, 0.487429052428485, 
	0.738324705129217, 0.575781351653492, -0.305388387156356, 1.51178116845085, 
	0.389843236411431, -0.621240580541804, -2.2146998871775, 1.12493091814311, 
	-0.0449336090152309, -0.0161902630989461, 0.94383621068530, 0.821221195098089, 
	0.593901321217509, 0.918977371608218, 0.782136300731067, 0.0745649833651906, 
	-1.98935169586337, 0.61982574789471, -0.0561287395290008, -0.155795506705329, 
	-1.47075238389927, -0.47815005510862, 0.417941560199702), .Dim = c(10L, 
	3L))
	
	b=structure(c(1.35867955152904, -0.102787727342996, 0.387671611559369, 
	-0.0538050405829051, -1.37705955682861, -0.41499456329968, -0.394289953710349, 
	-0.0593133967111857, 1.10002537198388, 0.763175748457544, -0.164523596253587, 
	-0.253361680136508, 0.696963375404737, 0.556663198673657, -0.68875569454952, 
	-0.70749515696212, 0.36458196213683, 0.768532924515416, -0.112346212150228, 
	0.881107726454215, 0.398105880367068, -0.612026393250771, 0.341119691424425, 
	-1.12936309608079, 1.43302370170104, 1.98039989850586, -0.367221476466509, 
	-1.04413462631653, 0.569719627442413, -0.135054603880824), .Dim = c(10L, 
	3L))
	
	
	nearest<-structure(list(nn.idx = structure(list(X1 = c(7L, 7L, 5L, 9L, 
	3L, 2L, 6L, 9L, 7L, 9L), X2 = c(2L, 6L, 2L, 8L, 6L, 3L, 10L, 
	8L, 2L, 5L), X3 = c(9L, 3L, 10L, 7L, 10L, 10L, 7L, 7L, 5L, 7L
	), X4 = c(5L, 9L, 9L, 6L, 2L, 6L, 9L, 6L, 9L, 2L), X5 = c(10L, 
	10L, 7L, 10L, 1L, 5L, 3L, 10L, 10L, 10L)), .Names = c("X1", "X2", 
	"X3", "X4", "X5"), row.names = c(NA, -10L), class = "data.frame"), 
	    nn.dists = structure(list(X1 = c(1.04301819567468, 0.782785251535478, 
	    0.514019762075841, 0.9436357260583, 1.46393847125353, 1.73157573316917, 
	    0.66791447696244, 0.852326186446708, 0.954406845715279, 0.395496580572611
	    ), X2 = c(1.35481071903339, 0.931412898425682, 0.574844301957827, 
	    0.945472961596115, 1.71518967014801, 1.95360681279363, 0.822782991518319, 
	    0.921390522381498, 1.06633538007411, 0.904080753178077), 
	        X3 = c(1.53376883835267, 1.06948509416105, 0.704879811283639, 
	        1.25256907321915, 1.95552547157995, 2.03639936314308, 
	        0.983420985126367, 1.30532148465522, 1.45844529983923, 
	        0.938940949941508), X4 = c(1.66464626768378, 1.27793083718640, 
	        0.849722423887674, 1.44966319723756, 2.00569777023645, 
	        2.179643484087, 1.07789743302845, 1.48904007614150, 1.49813576432115, 
	        1.19098185772077), X5 = c(1.82885863701822, 1.34897576181160, 
	        0.874908208472255, 1.56806650285981, 2.38117935086023, 
	        2.40067304459157, 1.16696237017602, 1.49288843286122, 
	        1.58019302443235, 1.23698083599426)), .Names = c("X1", 
	    "X2", "X3", "X4", "X5"), row.names = c(NA, -10L), class = "data.frame")), .Names = c("nn.idx", 
	"nn.dists"))
		
	nearest.func=nn2(a,b,k=5)
	
	checkEqualsNumeric(as.matrix(nearest.func[[1]]),as.matrix(nearest[[1]]))
	checkEqualsNumeric(as.matrix(nearest.func[[2]]),as.matrix(nearest[[2]]))
	
}

test.NN2.simple<-function(){
	res<-structure(list(nn.idx = structure(c(1L, 2L, 2L), .Dim = c(3L, 
	1L)), nn.dists = structure(c(0.01, 1, 2), .Dim = c(3L, 1L))), .Names = c("nn.idx", 
	"nn.dists"))
	
	res.func<-nn2(rbind(c(1,0),c(2,0)),rbind(c(1.01,0),c(3,0),c(4.0,0)),k=1)
	checkEquals(res,res.func)
}

# NB this fails with the version of ANN distributed with knnFinder v1.0
test.NN2.withIdenticalPoint<-function(){
	res<-structure(list(nn.idx = structure(c(1L, 2L, 2L), .Dim = c(3L, 
	1L)), nn.dists = structure(c(0.00, 1, 2), .Dim = c(3L, 1L))), .Names = c("nn.idx", 
	"nn.dists"))
	
	res.func<-nn2(rbind(c(1,0),c(2,0)),rbind(c(1.0,0),c(3,0),c(4.0,0)),k=1)
	checkEquals(res,res.func)
}

test.NN2.crosscheckSearchTypeAndTreeType<-function(){
	set.seed(1)
	a=matrix(rnorm(3000),ncol=3)
	b=matrix(rnorm(3000),ncol=3)
	n.standard<-nn2(a,b,k=5,searchtype='standard')
	n.priority<-nn2(a,b,k=5,searchtype='priority')
	n.bd.standard<-nn2(a,b,k=5,searchtype='standard',treetype='bd')
	n.bd.priority<-nn2(a,b,k=5,searchtype='priority',treetype='bd')

	checkEquals(n.standard,n.priority)
	checkEquals(n.standard,n.bd.standard)
	checkEquals(n.standard,n.bd.priority)
}